<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<title>invent</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" href="/images/favicon.ico"/>
  <link rel="stylesheet" href="/css/styles.css" />
  <link rel="stylesheet" href="/css/custom-fonts.css"/>
  <link rel="stylesheet" href="/bootstrap-3.3.7/css/bootstrap.min.css" />
  <link rel="stylesheet" href="/fontawesome-5.8.1/css/all.css"/>
  <link rel="stylesheet" href="/css/jquery.dataTables.min.css"> 
  <link rel="stylesheet" href="/css/editor.dataTables.min.css">
  <link rel="stylesheet" href="/css/select.dataTables.min.css" />
<link rel="stylesheet" href="/css/buttons.dataTables.min.css" />
  <script type="text/javascript" src="/js/jquery-3.4.0.min.js" ></script>
  <script type="text/javascript"  src="/js/jquery.dataTables.min.js"></script> 
  <script type="text/javascript"  src="/js/bootstrap-table.min.js"></script> 
  <script type="text/javascript"  src="/js/datatable.js"></script> 
  <script type="text/javascript"  src="/js/vue.js"></script>
  <script type="text/javascript"  src="/js/axios.min.js"></script>
  <script type="text/javascript"  src="/bootstrap-3.3.7/js/bootstrap.min.js"></script>
   <script type="text/javascript"  src="/js/prefixfree-1.0.7.js"></script>
  <script type="text/javascript"  src="/js/invent-scripts.js"></script>
  <script type="text/javascript"  src="/js/jquery.dataTables.min.js"></script>
   <!--  <script type="text/javascript"  src="/js/jquery.scrollTableBody.js"></script> -->
  <script type="text/javascript"  src="/js/dataTables.editor.min.js"></script>
  <script type="text/javascript" src="/js/dataTables.select.min.js"></script>
  <script type="text/javascript" src="/js/dataTables.buttons.min.js"></script>
  <style>
  
.fa-trash-alt{
	cursor:pointer;
}
.fa-edit{
	cursor:pointer;
}
table {
	width:100%;
	table-layout:fixed;
	margin:10px;
}
th, td {
	padding:5px 10px;
}
thead, tfoot {
	display:table;
	width:100%;
	width:calc(100% - 18px);
}
tbody {
	height:350px;
	overflow:auto;
	overflow-x:hidden;
	display:block;
	width:100%;
	background:Lavender;
}
tbody tr {
	display:table;
	width:100%;
	table-layout:fixed;
}
#userInput{
	border-radius:30px;
	background:#686d77;	
	text-align:center;
	color:white;
	padding:6px;

}
*:focus::-webkit-input-placeholder { 
	opacity: 0; 
} 
::-webkit-input-placeholder{
	color:white;
	font-family:Helvetica;
	font-size:12px;
}
  </style>
</head>
<body>
			 <div id="navbar-wrapper">
			        <header>
			            <nav class="navbar navbar-default navbar-fixed-top " id="nav-bg" role="navigation">
			                <div class="container-fluid">
			                    <div class="navbar-header">
			                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
			                            <span class="sr-only">Toggle navigation</span>
			                            <span class="icon-bar"></span>
			                            <span class="icon-bar"></span>
			                            <span class="icon-bar"></span>
			                        </button>
			                        <a class="navbar-brand" id="logo" href="/home">Invent</a>
			                    </div>
			                    <div id="navbar-collapse" class="collapse navbar-collapse">
			                        <ul class="nav navbar-nav navbar-right">
			               
			                            <li class="dropdown">
			                                <a id="user-profile" href="#" class="dropdown-toggle" data-toggle="dropdown"><img src="/images/user.png" class="img-responsive img-thumbnail img-circle"> Username</a>
			                                <ul class="dropdown-menu dropdown-block" role="menu">
			                                    <li><a href="#">Profile</a></li>
			                                    <li><a href="#">Logout</a></li>
			                                </ul>
			                            </li>
			                        </ul>
			                    </div>
			                </div>
			            </nav>
			        </header>
			    </div>
			    <div id="wrapper">
			        <div id="sidebar-wrapper">
			            <aside id="sidebar">
			                <ul id="sidemenu" class="sidebar-nav">
				                <li id="sidebar-section-title">
				                        <a>
				                            <span class="sidebar-title">Main Navigation</span>
				                        </a>
				                </li>
			                    <li id="menu-item">
			                        <a href="/home">
			                            <span class="sidebar-icon"><i class="fas fa-tachometer-alt"></i></span>
			                            <span class="sidebar-title">DashBoard</span>
			                        </a>
			                    </li>
			                    <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-1">
			                            <span class="sidebar-icon"><i class="fa fa-users"></i></span>
			                            <span class="sidebar-title">Users</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-1" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/add-user"><i class="fa fa-caret-right"></i>Add User</a></li>
			                            <li id="menu-sub-items"><a href="/manage-users"><i class="fa fa-caret-right"></i>Manage Users</a></li>
			                        </ul>
			                    </li>
			                    <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-2">
			                            <span class="sidebar-icon"><i class="fas fa-tools"></i></span>
			                            <span class="sidebar-title">General Settings</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-2" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/company"><i class="fa fa-caret-right"></i>Company Info</a></li>
			                        </ul>
			                    </li>
			                    <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-3">
			                            <span class="sidebar-icon"><i class="fab fa-product-hunt"></i></span>
			                            <span class="sidebar-title">Products</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-3" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/add-product"><i class="fa fa-caret-right"></i>Add Product</a></li>
			                            <li id="menu-sub-items"><a href="/manage-products"><i class="fa fa-caret-right"></i>Manage Products</a></li>
			                        </ul>
			                    </li>
			                     <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-4">
			                            <span class="sidebar-icon"><i class="fas fa-coins"></i></span>
			                            <span class="sidebar-title">Sales</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-4" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/sales"><i class="fa fa-caret-right"></i>New Sale</a></li>
			                        </ul>
			                    </li>
			                     <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-5">
			                            <span class="sidebar-icon"><i class="fas fa-file-invoice-dollar"></i></span>
			                            <span class="sidebar-title">Invoices</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-5" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/create-invoice"><i class="fa fa-caret-right"></i>Generate Invoice</a></li>
			                            <li id="menu-sub-items"><a href="/manage-invoices"><i class="fa fa-caret-right"></i>Invoice Management</a></li>
			                        </ul>
			                    </li>
			                    <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-6">
			                            <span class="sidebar-icon"><i class="fas fa-people-carry"></i></span>
			                            <span class="sidebar-title">Vendors</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-6" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/add-vendor"><i class="fa fa-caret-right"></i>Add Vendor</a></li>
			                            <li id="menu-sub-items"><a href="/manage-vendors"><i class="fa fa-caret-right"></i>Manage Vendors</a></li>
			                        </ul>
			                    </li>
			                    <li id="menu-item">
			                        <a class="accordion-toggle collapsed toggle-switch" data-toggle="collapse" href="#submenu-7">
			                            <span class="sidebar-icon"><i class="fas fa-cubes"></i></span>
			                            <span class="sidebar-title">Stock</span>
			                            <b class="caret"></b>
			                        </a>
			                        <ul id="submenu-7" class="panel-collapse collapse panel-switch" role="menu">
			                            <li id="menu-sub-items"><a href="/add-stock"><i class="fa fa-caret-right"></i>Add New Item</a></li>
			                            <li id="menu-sub-items"><a href="/update-stock"><i class="fa fa-caret-right"></i>Update Stock</a></li>
			                        </ul>
			                    </li>
			                    <li id="menu-item">
			                        <a href="/reports">
			                            <span class="sidebar-icon"><i class="far fa-chart-bar"></i></span>
			                            <span class="sidebar-title">Reports</span>
			                        </a>
			                    </li>
			                </ul>
			            </aside>            
			        </div>
			        <div id="content-wrapper">
							<div class="breadcrumb-section">
								<a href="/home" class="inactive" >Home</a>
								<a href="/manage-products" class="active">Manage Products</a>
							</div>

				        <table class="table table-hover header-fixed" id="dataTable">
					        		<thead>
					        			<tr>
					        				<th colspan="5"> 
                                                 <div class="btn-addNew"><p href="#modal-1" data-toggle="modal" id="addNew-text"><i class="fas fa-plus-circle"></i>&nbsp;<span class="addNew-txt">Add New</span></p></div>
							        			 <a><input type="text" id="userInput" onkeyup="searchProduct()" placeholder="Search products..."></a>
							        			 <div class="btn-refresh" v-on:click="fetchProducts"><p id="refresh-text"><span class="refresh-txt">Refresh</span>&nbsp;<i class="fas fa-sync-alt "></i></p></div>
							        			 
							        		</th>
					        			</tr>
					        		</thead>
				                   <thead>
				                        <tr style="background:#193666;color:white;">
				                            <th class="col-xs-1" style="display:none;">ID</th>
											<th class="col-xs-2">Product No</th>
				                            <th class="col-xs-3">Product Name</th>
				                            <th class="col-xs-2">Quantity</th>
				                            <th class="col-xs-1">Action</th>
				                        </tr>
				                    </thead>
				              
				                    <tbody>
				                    	<tr v-for="(item,index) in products" style="border:none">
				                    		<td class="col-xs-1" style="display:none;">{{item.id}}</td>
				                            <td class="col-xs-2">{{item.productNo}}</td>
				                    		<td class="col-xs-3">{{item.productName}}</td>
				                    		<td class="col-xs-2">{{item.quantity}}</td>
				                    		<td class="col-xs-1">
			                            <a href="#editProductModal" 
				                               class="edit" data-toggle="modal"><i class="fas fa-edit" 
				                               data-toggle="tooltip" 
				                               title="Edit"></i>
			                            </a> &nbsp; &nbsp;
			                            <a href="#deleteProductModal" 
			                            		v-on:click.prevent="deleteProduct(item,index)"
					                           	 class="delete" data-toggle="modal"><i class="fas fa-trash-alt" 
					                           	 data-toggle="tooltip" 
					                             title="Delete"></i>
			                             </a>
                       					 </td>
				                    	</tr>
				                    </tbody>
				                    <tfoot>
				                        <tr style="background:#193666;color:white;">
				                            <th class="col-xs-1" style="display:none;">ID</th>
				                            <th class="col-xs-2">Product No</th>
				                            <th class="col-xs-3">Product Name</th>                       
				                            <th class="col-xs-2">Quantity</th>
				                            <th class="col-xs-1">Action</th>
				                        </tr>
				                    </tfoot>
                		</table>
								        <!-- Add Modals HTML -->
						                  <!-- #modal 1 -->
						<div class="modal fade" id="modal-1">
						      <div class="modal-dialog">
						        <div class="modal-content" id="validated-form" v-pre>
						          <div class="modal-header">
						            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
						            <h4 class="modal-title">Add Product</h4>
						          </div>
						          <form>
						                  <div class="modal-body">

				
													   <div class="form-group">
													           <label for="productName">Product Name</label>
													           <input type="text" 
													                  class="form-control"
													                  name="productName" 
													                  placeholder="" 
													                  value="" 
													                  id="productName" 
													                  v-model="productName" required>
													            <span class="text-danger" 
														               v-if="validationErrors.productName" 
														             v-text="validationErrors.productName">
														        </span>
													
													   </div>
													   <div class="form-group">
													           <label>Product No</label>
													           <input type="text" 
													                  class="form-control" 
													                  name="productNo"
													                  placeholder=""
													                  value="" 
													                  id="productNo" 
													                  v-model="productNo" required>
													            <span class="text-danger" 
													            	   v-if="validationErrors.productNo" 
													            	 v-text="validationErrors.productNo">
													            </span>
													   </div>
													   <div class="form-group">
													           <label>Quantity</label>
													           <input type="number" 
													                  class="form-control" 
													                  name="quantity"
													                  placeholder=""
													                  value="" 
													                  id="quantity" 
													                  v-model="quantity" required>
													            <span class="text-danger" 
													            	   v-if="validationErrors.quantity"
													            	 v-text="validationErrors.quantity">
													            </span>
													   </div>
									   </div>	   
									   <div class="modal-footer">
												            <button type="button" 
												                    class="btn" 
												                     v-on:click.prevent="resetForm">Reset
												            </button>
										                    <button class="btn btn-success" 
										                            type="submit" 
										                            v-on:click.prevent="saveProduct">Save
										                    </button>
					                    </div>
						         
				                    </form>

						          
						        </div><!-- /.modal-content -->

						      </div><!-- /.modal-dialog -->
						                  </div><!-- /.modal -->  
						

				  <!-- Edit Modal HTML -->
				  
				  <div id="editProductModal" class="modal fade">
				    <div class="modal-dialog">
				      <div class="modal-content">
				        <form>
				          <div class="modal-header">            
				            <h4 class="modal-title">Edit Product</h4>
				            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				          </div>
				          <div class="modal-body">          
				            <div class="form-group">
				              <label>Product Name</label>
				              <input type="text" class="form-control" required>
				            </div>
				            <div class="form-group">
				              <label>Product No</label>
				              <input type="text" class="form-control" required>
				            </div>
				            <div class="form-group">
				              <label>Quantity</label>
				              <input type="number" class="form-control" required>
				            </div>          
				          </div>
				          <div class="modal-footer">
								<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
            					<input type="submit" class="btn btn-info" value="Save">
				          </div>
				        </form>
				      </div>
				    </div>
				  </div>
				 
				  <!-- Delete Modal HTML -->
				  
				  <div id="deleteProductModal" class="modal fade">
				    <div class="modal-dialog">
				      <div class="modal-content">
				        <form>
				          <div class="modal-header">            
				            <h4 class="modal-title">Delete Product</h4>
				            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				          </div>
				          <div class="modal-body">          
				            <p>Are you sure you want to delete this Product?</p>
				            <p class="text-warning"><small>This action cannot be undone.</small></p>
				          </div>
				          <div class="modal-footer">
				            <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
				            <input type="submit" class="btn btn-danger" value="Delete">
				          </div>
				        </form>
				      </div>
				    </div>
				  </div>
				        	
	    </div>
			        <div id="footer">
			        <p>Copyright &copy;2019&nbsp;|&nbsp;All Rights Reserved</p>
			        </div>
			    </div> 
  
  <script type="text/javascript">
  new Vue({
	    el: '#content-wrapper',
	    data: function () {
	      return {
	        products: Array,
	        productNo:'',
	        productName:'',
	        quantity:''        
	      }
	      
	    },
	    mounted: function () {
	      this.fetchProducts();
	    },
	    methods: {
	    	fetchProducts: function () {
	    	      axios.get('/api/products').then(function (response) {
	    	        this.products = response.data
	    	      }.bind(this)).catch(function (error) {
	    	        console.log('Error while fetching product data: ' + error)
	    	      })
	    	    },
		    deleteProduct:function(item,id){
		    	axios.delete('/api/products/'+item.id)
		    	.then(response=>{
		    		this.product.splice(id,1)
		    	})

		    },
		    checkAll:function() {
			        var checkboxes = document.getElementsByTagName('input');
			   	 var val = null;
			        for (var i = 0; i < checkboxes.length; i++) {
			            if (checkboxes[i].type == 'checkbox') {
			                if (val === null) val = checkboxes[i].checked;
			                checkboxes[i].checked = val;
			            }
			        }
		    }
	    }
	  });
	  var app = new Vue({
		    el: '#validated-form',
		    data: function () {
		        return {
	                productName: '',
	                productNo: '',
	                quantity: '',
		            validationErrors: {
		                productName: null,
		                productNo: null,
		                quantity: null
		    	        
		            }
		        }

		    },
		    methods: {
		        saveProduct:function() {
		            if (this.validateForm()) {
		                //submit form to backend
			   	           axios.post('/api/products/save',{
				   	             productName:this.productName,
				   	             productNo:this.productNo,
				   	             quantity:this.quantity
				   	           }).then(this.resetForm())
		            }
		        },
		        validateForm:function() {
		            var formId = 'validated-form';
		            var nodes = document.querySelectorAll(`#${formId} :invalid`);
		            var errorObjectName = 'validationErrors';
		            var vm = this; //current vue instance;

		            Object.keys(this[errorObjectName]).forEach(key => {
		                this[errorObjectName][key] = null
		            });

		            if (nodes.length > 0) {
		                nodes.forEach(node => {
		                    this[errorObjectName][node.name] = node.validationMessage;
		                    node.addEventListener('change', function (e) {
		                        vm.validateForm();
		                    });
		                });

		                return false;
		            }
		            else {
		                return true;
		            }
		        },
		        closeModal:function(){
		  			this.show=false
		  		},
		  		resetForm:function(){
		    		this.productName='',
		    		this.productNo='',
		    		this.quantity='',
		    		this.show=false
		    	}
		    }
		});
	  
  </script>  
</body>
</html>